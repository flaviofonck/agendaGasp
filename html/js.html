<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

<script>
    function crearTablaContactos() {
        const tablaExistente = document.getElementById('tablaContactos');
        if (tablaExistente) tablaExistente.remove();

        google.script.run.withSuccessHandler(function(obj) {
            const tabla = document.createElement('table');
            tabla.id = 'tablaContactos';
            const tablaHeader = document.createElement('thead');
            const tablabody = document.createElement('tbody');

            for (let i = 0; i < obj.length; i++) {
                const filaActual = obj[i];
                const fila = document.createElement('tr');

                for (let j = 0; j < filaActual.length; j++) {
                    const celdaActual = filaActual[j];
                    const celda = i === 0 ? document.createElement('th') : document.createElement('td');
                    celda.textContent = celdaActual;
                    fila.appendChild(celda);
                }

                (i === 0 ? tablaHeader : tablabody).appendChild(fila);
            }

            tablaHeader.classList.add('table-dark');
            tabla.appendChild(tablaHeader);
            tabla.appendChild(tablabody);
            tabla.classList.add('table', 'table-striped', 'border', 'border-3');

            document.getElementById('divContactos').appendChild(tabla);
        }).obtenerContactos();
    }
</script>



 <script>
    function crearTablaContactos_1()
    {
        let tabla = document.getElementById('tablaContactos');
        if (tabla) tabla.remove();
        google.script.run.withSuccessHandler(
            function(obj)
            {
                let tabla = document.createElement('table');
                tabla.id = 'tablaContactos';
                let tablaHeader = document.createElement('thead');
                let tablabody = document.createElement('tbody');
                Array.from(obj).forEach((filaActual, i) => 
                {
                    let fila = document.createElement('tr');
                    filaActual.forEach( celdaActual => 
                    {
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if(i == 0)
                    {
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }else
                    {
                        tablabody.appendChild(fila);
                    }
                });
                // agregamos clases a la cabecera
                tablaHeader.classList.add('table-dark');
                // agregamos el cuerpo de la tabla
                tabla.appendChild(tablabody);
                // agregamos las clases de la tabla
                tabla.classList.add('table','table-striped','border','border-3');
                // agregamos la tabla al document
                document.getElementById('divContactos').appendChild(tabla);
 
            }).obtenerContactos();
    }
</script>
<script>
    function crearTablaContactos_gpt() {
        const tablaExistente = document.getElementById('tablaContactos');
        if (tablaExistente) tablaExistente.remove();

        google.script.run.withSuccessHandler(function(obj) {
            const tabla = document.createElement('table');
            tabla.id = 'tablaContactos';
            const tablaHeader = document.createElement('thead');
            const tablabody = document.createElement('tbody');

            obj.forEach((filaActual, i) => {
                const fila = document.createElement('tr');
                filaActual.forEach(celdaActual => {
                    const celda = i === 0 ? document.createElement('th') : document.createElement('td');
                    celda.textContent = celdaActual;
                    fila.appendChild(celda);
                });

                (i === 0 ? tablaHeader : tablabody).appendChild(fila);
            });

            tablaHeader.classList.add('table-dark');
            tabla.appendChild(tablaHeader);
            tabla.appendChild(tablabody);
            tabla.classList.add('table', 'table-striped', 'border', 'border-3');

            document.getElementById('divContactos').appendChild(tabla);
        }).obtenerContactos();
    }
</script>
